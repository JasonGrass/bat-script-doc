# 第三章 FOR 命令中的变量

FOR 命令中有一些变量,他们的用法许多新手朋友还不太了解,今天给大家讲解他们的用法!
先把 FOR 的变量全部列出来:
~I - 删除任何引号(")，扩展 %I
%~fI - 将 %I 扩展到一个完全合格的路径名
%~dI - 仅将 %I 扩展到一个驱动器号
%~pI - 仅将 %I 扩展到一个路径
%~nI - 仅将 %I 扩展到一个文件名
%~xI - 仅将 %I 扩展到一个文件扩展名
%~sI - 扩展的路径只含有短名
%~aI - 将 %I 扩展到文件的文件属性
%~tI - 将 %I 扩展到文件的日期/时间
%~zI - 将 %I 扩展到文件的大小
%~$PATH:I - 查找列在路径环境变量的目录，并将 %I 扩展
到找到的第一个完全合格的名称。如果环境变量名
未被定义，或者没有找到文件，此组合键会扩展到
空字符串
我们可以看到每行都有一个大写字母"I",这个 I 其实就是我们在 FOR 带入的变量,我们 FOR
语句代入的变量名是什么,这里就写什么.
比如:FOR /F %%z IN ('set') DO @echo %%z
这里我们代入的变量名是 z 那么我们就要把那个 I 改成 z,例如%~fI 改为%~fz
至于前面的%~p 这样的内容就是语法了!

好开始讲解:

## 一、 ~I - 删除任何引号(")，扩展 %I

这个变量的作用就如他的说明,删除引号!我们来看这个例子:
首先建立临时文件 temp.txt，内容如下
"1111
"2222"
3333"
"4444"44
"55"55"55
可建立个 BAT 文件代码如下:
@echo off
echo ^"1111>temp.txt
echo "2222">>temp.txt
echo 3333^">>temp.txt
echo "4444"44>>temp.txt
echo ^"55"55"55>>temp.txt
rem 上面建立临时文件，注意不成对的引号要加转义字符^，重定向符号前不要留空格
FOR /F "delims=" %%i IN (temp.txt) DO echo %%~i
pause
del temp.txt
执行后,我们看 CMD 的回显如下:
1111 #字符串前的引号被删除了
2222 #字符串首尾的引号都被删除了
3333" #字符串前无引号，后面的引号保留
4444"44 #字符串前面的引号删除了，而中间的引号保留
55"55"55 #字符串前面的引号删除了，而中间的引号保留
请按任意键继续. . .
和之前 temp.txt 中的内容对比一下,我们会发现第 1、 2、 5 行的引号都消失了,这就是删除引
号~i 的作用了!
删除引号规则如下(BAT 兄补充!)
1、若字符串首尾同时存在引号，则删除首尾的引号；
2、若字符串尾不存在引号，则删除字符串首的引号；
3、如果字符串中间存在引号，或者只在尾部存在引号，则不删除。
龙卷风补充：无头不删，有头连尾删。

## 二、 %~fI - 将 %I 扩展到一个完全合格的路径名

看例子:
把代码保存放在随便哪个地方,我这里就放桌面吧.
FOR /F "delims==" %%i IN ('dir /b') DO @echo %%~fi
pause
执行后显示内容如下
C:\Documents and Settings\Administrator\桌面\test.bat
C:\Documents and Settings\Administrator\桌面\test.vbs
当我把代码中的 %%~fi 直接改成%%i
FOR /F "delims==" %%i IN ('dir /b') DO @echo %%ipause
执行后就会显示以下内容：
test.bat
test.vbs
通过对比,我们很容易就看出没有路径了,这就是"将 %I 扩展到一个完全合格的路径名"的作
用
也就是如果%i 变量的内容是一个文件名的话,他就会把这个文件所在的绝对路径打印出来,
而不只单单打印一个文件名,自己动手动实验下就知道了!

## 三、 %~dI - 仅将 %I 扩展到一个驱动器号

看例子:
代码如下,我还是放到桌面执行!
FOR /F "delims==" %%i IN ('dir /b') DO @echo %%~di
pause
执行后我 CMD 里显示如下
C:
C:
我桌面就两个文件 test.bat,test.vbs,%%~di 作用是,如果变量%%i 的内容是一个文件或者目录
名,他就会把他这文件
或者目录所在的盘符号打印出来!

## 四、 %~pI - 仅将 %I 扩展到一个路径

这个用法和上面一样,他只打印路径不打印文件名字
FOR /F "delims==" %%i IN ('dir /b') DO @echo %%~pi
pause
我就不打结果了,大家自己复制代码看结果吧,下面几个都是这么个用法,代码给出来,大家自
己看结果吧!

## 五、 %~nI - 仅将 %I 扩展到一个文件名

只打印文件名字
FOR /F "delims==" %%i IN ('dir /b') DO @echo %%~ni
pause

## 六、 %~xI - 仅将 %I 扩展到一个文件扩展名

只打印文件的扩展名FOR /F "delims==" %%i IN ('dir /b') DO @echo %%~xi
pause

## 七、 %~sI - 扩展的路径只含有短名

打印绝对短文件名
FOR /F "delims==" %%i IN ('dir /b') DO @echo %%~si
pause

## 八、 %~aI - 将 %I 扩展到文件的文件属性

打印文件的属性
FOR /F "delims==" %%i IN ('dir /b') DO @echo %%~ai
pause

## 九、 %~tI - 将 %I 扩展到文件的日期/时间

打印文件建立的日期
FOR /F "delims==" %%i IN ('dir /b') DO @echo %%~ti
pause

## 十、 %~zI - 将 %I 扩展到文件的大小

打印文件的大小
FOR /F "delims==" %%i IN ('dir /b') DO @echo %%~zi
pause
龙卷风补充：上面例子中的"delims=="可以改为"delims="，即不要分隔符

## 十一、 %~$PATH:I - 查找列在路径环境变量的目录，并将 %I 扩展

到找到的第一个完全合格的名称。如果环境变量名
未被定义，或者没有找到文件，此组合键会扩展到
空字符串
这是最后一个,和上面那些都不一样,我单独说说!然后在把这些代码保存为批处理,放在桌面。
@echo off
FOR /F "delims=" %%i IN (“notepad.exe”) DO echo %%~$PATH:i
pause
龙卷风补充：上面代码显示结果为 C:\WINDOWS\system32\notepad.exe
他的意思就在 PATH 变量里指定的路径里搜索 notepad.exe 文件，如果有 notepad.exe 则会把
他所在绝对路径打印出来，没有就打印一个错误！

好了,FOR 的的变量就介绍到这了!

BY 伤脑筋

好了，理科学习告一段落，请欣赏《千字文》第一节：
【原文】
天(tiān) 地(dì) 玄(xuán) 黄(huáng) ，
宇(yǔ) 宙(zhîu) 洪(hïng) 荒(huāng) 。
日(rì) 月(yuâ) 盈(yíng) 昃(zâ) ，
辰(chãn) 宿(xiù) 列(liâ) 张(zhāng) 。
（1）天：太空，地球周围诸星罗列的空间。
（2）地：指地球，人类和动物、植物栖息生长的场所。
（3）玄黄：形容在远古地球刚诞生时的景象，新的天体正在组成，天地之间一片浑沌
炽热。天空因大气燃烧而赤黑又变化莫测，所以称之为“天玄”。大地因燃烧而变得焦黄，
所以称之为“地黄”。玄，黑中带红的颜色，后来多指黑色；深远莫测的。黄，黄色，与红、
蓝合称三原色。出自于《易经》：夫玄黄者，天地之杂也，天玄而地黄。
（4）宇宙：时空的总合。宇，上下四方无限广大的空间。宙，古往今来无限久远的时
间。出自于《淮南子》：上下四方叫作宇,古往今来叫作宙。
（5）洪荒：远古时期地球有很大的面积以及很长一段时间被洪水所淹没，到处
显得荒芜凄凉。洪，大；大水。荒，杂草丛生。出自于西汉? 杨雄《太玄经》：洪荒之
世。
（6）日：太阳。
（7）月：月亮。
（8）盈：充满，此指月圆。月亮盈亏的变化，阴历每月十五日是满月，又称望月、盈
月；三十日月尽，没有月光。
（9）昃：倾斜，指太阳西斜。太阳每天东升西落，早上从东边升起，正午时位置最高，
过了正午向西边斜落。
（10）辰宿：星辰。辰：星体的总称。宿：星群、星座。单颗星体称星，一颗以上称宿。
（11）列张：陈列分布。列，陈列。张，分布。出自《淮南子》：天设日月，列星辰，
调阴阳，张四时。
【译文参考】
在地球刚诞生的时候，地球的四周被浑沌不清、变幻莫测的赤黑色气体所包围，而大地
则是枯黄的一片。到处都是大水，举目所见一片荒凉。
经过很长的一段时间后，天地之间慢慢澄清了，这时可以看到太阳、月亮很有规律的在
天空中运行着，日出日落， 月圆月缺。在无边无际的天空中布满了大大小小的星星。
